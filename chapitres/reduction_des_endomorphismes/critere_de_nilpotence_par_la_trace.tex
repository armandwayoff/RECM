Les résultats que nous allons montrer par la suite peuvent être résumés par le diagramme suivant:
\begin{figure*}[h!]
    $$
    \begin{tikzcd}
    	& {\text{si pour tout } k \in \llbracket 1, n-1 \rrbracket, \mathrm{Tr}(A^k)=0 \text{ et si \dots}} & {} \\
    	{A \text{ est nilpotente}} && {A \text{ est diagonalisable}}
    	\arrow["{\dots \mathrm{Tr}(A^n) \not= 0}"{description}, curve={height=6pt}, Rightarrow, from=1-2, to=2-3]
    	\arrow["{\dots \mathrm{Tr}(A^n)=0}"{description}, curve={height=-6pt}, Rightarrow, 2tail reversed, from=1-2, to=2-1]
    \end{tikzcd}
    $$
\end{figure*}

Intéressons-nous d'abord à la branche de gauche.
\begin{prop}{}
    Soit $A \in \M_n(\K)$. La matrice $A$ est nilpotente si et seulement si pour tout $k \in \llbracket 1, n \rrbracket, \Tr(A^k) = 0$.
\end{prop}
\begin{preuve}
    \marginnote[-1cm]{\url{http://vonbuhren.free.fr/Agregation/Developpements/dev_thm_burnside.pdf}}
    Raisonnons par double implication.
    \marginnote[1cm]{
        \note Soit $A$ une matrice semblable à
        $$
        \begin{pmatrix}
            \lambda_1 & \star & \cdots & \star \\
            0 & \lambda_2 & \cdots & \star \\
            \vdots & \ddots &\ddots & \vdots \\
            0 & \cdots & 0 & \lambda_n
        \end{pmatrix}.
        $$
        Alors la matrice $A^k$ est semblable à
        $$
        \begin{pmatrix}
            \lambda_1^k & \star & \cdots & \star \\
            0 & \lambda_2^k & \cdots & \star \\
            \vdots & \ddots &\ddots & \vdots \\
            0 & \cdots & 0 & \lambda_n^k
        \end{pmatrix}.
        $$
    }
    
    %\marginnote[3cm]{
    % https://tex.stackexchange.com/questions/343439/how-to-draw-this-special-matrix-with-two-diagonal-braces
    %}
    \begin{itemize}
        \item[$(\Rightarrow)$] Si la matrice $A$ est nilpotente, son spectre est réduit à $0$ et donc elle est semblable à une matrice strictement triangulaire $T$. Pour tout $k \in \llbracket 1, n \rrbracket$, la matrice $A^k$ est semblable à la matrice $T^k$ dont la diagonale est nulle \note. La trace étant un invariant de similitude, on en déduit que pour tout $k \in \llbracket 1, n \rrbracket$, $\Tr(A^k) = \Tr(T^k) = 0$.
        \item[$(\Leftarrow)$] Réciproquement, supposons que la matrice $A$ n'est pas nilpotente. On désigne par $\lambda_1, \dots, \lambda_r \in \C$ les valeurs propres non nulles deux à deux distinctes de $A$ (qui existent car le polynôme $\chi_A \in \C[X]$ est scindé) et $m_1, \dots, m_r \in \Ne$ leur multiplicité respective. En trigonalisant la matrice $A$, notre hypothèse équivaut à
        $$\forall k \in \llbracket 1, n \rrbracket,\ \sum_{i=1}^r m_i \lambda_i^k = 0.$$
        En effet, la valeur propre $\lambda_i$ est présente $m_i$ fois sur la diagonale. \\
        En particulier, en se limitant à $k \in \llbracket 1, r \rrbracket$, ces relations se traduisent matriciellement par
        $$
        \underbrace{
        \begin{pmatrix}
        \lambda_1 & \cdots & \lambda_r \\
        \vdots & & \vdots \\
        \lambda_1^r & \cdots & \lambda_r^r
        \end{pmatrix}
        }_{\defeq V}
        \underbrace{
        \begin{pmatrix}
            m_1 \\ \vdots \\ m_r
        \end{pmatrix}
        }_{\defeq X}
        = 
        \begin{pmatrix}
        0 \\ \vdots \\ 0
        \end{pmatrix}.
        $$
        
        %$$
        %A^k \sim
        %\begin{tikzpicture}[decoration={brace,amplitude=5pt},baseline=(current bounding box.west)]
        %\matrix (magic) [matrix of math nodes,left delimiter=(,right delimiter=)] {
        %\lambda_1^k \\
        %& \ddots \\
        %& & \lambda_1^k \\
        %& & & \ddots \\
        %& & & & \lambda_r^k \\
        %& & & & & \ddots \\
        %& & & & & & \lambda_r^k \\
        %};
        %\draw[decorate] (magic-1-1.north) -- (magic-3-3.north east) node[above=5pt,midway,sloped] {$m_1$};
        %\draw[decorate] (magic-5-5.north east) -- (magic-7-7.north east) node[above=5pt,midway,sloped] %{$m_r$};
        %\end{tikzpicture}
        %$$

        Ainsi $X \in \Ker(V)$. Or la matrice $V$ est une matrice de \textsc{Vandermonde} inversible car les $\lambda_i$ sont deux à deux distinctes par hypothèse. Nous aboutissons alors à une contradiction car le vecteur $X$ est non nul. On en déduit que la matrice $A$ est nilpotente. \\
        
        Voyons une autre démonstration pour la réciproque. \\ \marginnote[0cm]{\url{https://www.youtube.com/watch?v=d70IfThN_-A}}
        \item[$(\Leftarrow)$] Montrons par récurrence que la matrice $A$ est nilpotente. Plus précisément pour $n \in \N$ on note
        \begin{center}
            $\mathscr{P}_n$: \say{ Soit $A \in \M_n(\K)$. Si pour tout $k \in \llbracket 1, n \rrbracket, \Tr(A^k) = 0$ alors la matrice $A$ est nilpotente }.
        \end{center}
        Montrons d'abord le lemme suivant.
        \begin{lemme}
            Soit $A \in \M_n(\K)$ telle que pour tout $k \in \llbracket 1, n \rrbracket, \Tr(A^k) = 0$. Montrons que $0 \in \Sp(A)$.
        \end{lemme}
        On note $\chi_A(X) \defeq \sum\limits_{k=0}^n a_k X^k$. D'après le théorème de \textsc{Cayley}-\textsc{Hamilton}, $\sum\limits_{k=0}^n a_k A^k = 0$. En composant cette relation par la trace, qui est linéaire, et d'après les hypothèses, 
        $$a_n \times 0 + \cdots + a_1 \times 0 + a_0 \times n = 0.$$
        D'où $a_0 = 0$ et $\chi_A(0) = 0$ donc $0$ est racine du polynôme caractéristique de la matrice $A$ i.e. $0 \in \Sp(A)$. \\
        
        Revenons à la démonstration de la récurrence.
        \begin{itemize}
            \item[$\rhd$] Initialisation pour $n=1$ : $\Tr(A) = 0$ donc $A = 0$ et $A$ est nilpotente. 
            \item[$\rhd$] Hérédité: soit $A \in \M_n(\K)$ telle que pour tout $k \in \llbracket 1, n \rrbracket, \Tr(A^k) = 0$. \\
            D'après le lemme, $0 \in \Sp(A)$. Soit $u$ un vecteur propre de $A$ associé à $0$ et soit $(u, u_2, \dots, u_n)$ une base de $\M_{n,1}(\K)$. Alors en notant $B$ une matrice carrée de taille $n-1$, 
            $$A \sim 
            \begin{pmatrix}
            0 & \star & \cdots & \star \\
            \vdots & & B & \\
            0 & & &
            \end{pmatrix}
            \text{ et }
            A^k \sim 
            \begin{pmatrix}
            0 & \star & \cdots & \star \\
            \vdots & & B^k & \\
            0 & & &
            \end{pmatrix}.
            $$
            D'après les hypothèses sur la trace des $A^k$, pour tout $k \in \llbracket 1, n-1 \rrbracket, \Tr(B^k) = 0$. Ainsi, en appliquant $\mathscr{P}_{n-1}$, la matrice $B$ est nilpotente. On en déduit, d'après les opérations sur les matrices par blocs, que
            $$\chi_A(X) = X \chi_{B}(X) = X \times X^{n-1} = X^n.$$
            Ainsi, d'après le théorème de \textsc{Cayley}-\textsc{Hamilton}, la matrice $A$ est nilpotente. 
        \end{itemize}
    \end{itemize}
\end{preuve}

Intéressons-nous maintenant à la branche de droite du diagramme.
\begin{prop}{}
    Soit $A \in \M_n(\K)$. Si pour tout $k \in \llbracket 1, n-1 \rrbracket, \Tr(A^k) = 0$ et $\Tr(A^n) \not= 0$ alors la matrice $A$ est diagonalisable. 
\end{prop}
Le démonstration de ce résultat reprend la démarche de la première démonstration de la réciproque du résultat précédent.
\newcommand{\vandermondepartiel}{
\left(\begin{gathered}
    \tikzpicture[every node/.style={anchor=south west}]
        \node[minimum width=1.5cm,minimum height=0.5cm] at (0.125,1.25) {\LARGE $V_k$};
        
        \node[minimum width=0.5cm,minimum height=0.5cm] at (0,0) {$\star$};
        \node[minimum width=0.5cm,minimum height=0.5cm] at (0.55,0) {$\cdots$};
        \node[minimum width=0.5cm,minimum height=0.5cm] at (1.25,0) {$\star$};
        
        \node[minimum width=0.5cm,minimum height=0.5cm] at (0,0.375) {$\vdots$};
        \node[minimum width=0.5cm,minimum height=0.5cm] at (1.25,0.375) {$\vdots$};
        
        \node[minimum width=0.5cm,minimum height=0.5cm] at (0,0.75) {$\star$};
        \node[minimum width=0.5cm,minimum height=0.5cm] at (0.55,0.75) {$\cdots$};
        \node[minimum width=0.5cm,minimum height=0.5cm] at (1.25,0.75) {$\star$};

        \draw (0, 1.25) -- (1.75, 1.25);
    \endtikzpicture
    \end{gathered}\right)
}
\begin{preuve}
    \begin{itemize}
        \item Montrons d'abord que la matrice $A$ possède au moins une valeur propre non nulle. \\
        La matrice $A$ est trigonalisable dans $\C$ et on note $\lambda_1, \dots, \lambda_n$ ses valeurs propres. Alors la matrice $A^n$ est semblable à la matrice
        $$
        \begin{pmatrix}
            \lambda_1^n & \star & \cdots & \star \\
            0 & \lambda_2^n & \cdots & \star \\
            \vdots & \ddots &\ddots & \vdots \\
            0 & \cdots & 0 & \lambda_n^n
        \end{pmatrix}.
        $$
        Or, par hypothèse, $\Tr(A^n) \not= 0$ donc les $\lambda_i$ ne peuvent pas être tous nuls et la matrice $A$ possède au moins une valeur propre non nulle.
        \item Montrons maintenant que la matrice $A$ possède $n$ valeurs propres distinctes ce qui assurera sa diagonalisabilité. \\
        On note $\alpha_1, \dots, \alpha_k$ les valeurs propres non nulles deux à deux distinctes de $A$ (qui existent d'après le premier point), $n_1, \dots, n_k$ leurs multiplicités respectives et 
        $$
        V \defeq \begin{pmatrix}
            \alpha_1 & \cdots & \alpha_k \\
            \vdots & & \vdots \\
            \alpha_1^{n-1} & \cdots & \alpha_k^{n-1}
        \end{pmatrix}
        \in \M_{n-1,k}(\C).
        $$
        Montrons que $N \defeq \Trsp{\begin{pmatrix} n_1  \cdots n_k \end{pmatrix}} \in \Ker(V)$. On calcule
        \begin{align*}
            V N = 
            \begin{pmatrix}
                \sum\limits_{i=1}^n \alpha_i n_i \\ 
                \vdots \\ 
                \sum\limits_{i=1}^n \alpha_i^{n-1} n_i
            \end{pmatrix}
            = 
            \begin{pmatrix}
                \Tr{A} \\ \vdots \\ \Tr{A^{n-1}}
            \end{pmatrix}
            =
            0_n
        \end{align*}
        Supposons par l'absurde que $k < n$. \\
        Réécrivons la relation précédente en extrayant de la matrice $V$ une matrice de \textsc{Vandermonde} carrée de taille $k$ notée $V_k$:
        $$V N = \vandermondepartiel N = 0_n$$
        et
        $$V_k N = 0.$$
        Comme $V_k$ est une matrice de \textsc{Vandermonde} et que les $\alpha_1, \dots, \alpha_k$ sont deux à deux distincts alors elle est inversible et donc
        $$N = 0.$$
        Ainsi, la matrice $A$ ne possède pas de valeur propre non nulle ce qui est absurde d'après le premier point. \\
        On en déduit que $k \geqslant n$ et comme $k \leqslant n$, $k=n$. Ainsi, la matrice $A$ possède $n$ valeurs propres distinctes et est donc diagonalisable.
    \end{itemize}
\end{preuve}

On déduit des propositions \textcolor{red}{4.6} et \textcolor{red}{4.7} le résultat suivant.
\begin{prop}{}
    Soit $A \in \M_n(\K)$. Si pour tout $k \in \llbracket 1, n-1 \rrbracket, \Tr(A^k) = 0$ alors la matrice $A$ est nilpotente ou diagonalisable.
\end{prop}

\marginnote[0cm]{(\url{https://fr.wikipedia.org/wiki/Polynôme_caractéristique#Coefficients})
$$\note \det(X \I_n - M) = X^n - f_1(M) X^{n-1} + \cdots + (-1)^n f_n(M)$$
où, en notant $(\lambda_1, \dots, \lambda_n)$ les valeurs propres de $M$ prises avec multiplicité,
$$f_k(M) = s_k(\lambda_1, \dots, \lambda_n)$$
où $s_k$ désigne le $k$-ème polynôme symétrique élémentaire. \\
Grâce aux identités de \textsc{Newton}, les coefficients $f_k(M)$ s'expriment comme des fonctions polynomiales des sommes de \textsc{Newton} des valeurs propres:
$$\sum_{i=1}^n \lambda_i^j = \Tr(M^j).$$
}

\begin{preuve}
    \textcolor{red}{à revoir} \\
    \marginnote[0cm]{\cite{reduc_des_endo} p. 114}
    D'après les formules des sommes de \textsc{Newton} et les relations coefficients-racines \note, le polynôme caractéristique de la matrice $A$ a pour expression
    $$\chi_A = X^n + (-1)^n \det(A).$$
    Si $\det(A) = 0$, le théorème de \textsc{Cayley}-\textsc{Hamilton} assure que $A$ est nilpotente. Sinon, le polynôme caractéristique est scindé à racines simples donc $A$ est diagonalisable (et d'ailleurs, toutes les valeurs propres ont le même module).
\end{preuve}
