\section{Permutation somme/intégrale}

%-----------
\subsection{Du continu au discret}

\begin{prop}{Développement asymptotique de la factorielle}
Il existe une constante $\delta$ telle que
\[
n! = \delta n^{n + \frac{1}{2}} \e^{-n} \left(1 + \frac{1}{12 n} + o\left(\frac{1}{n}\right)\right).
\]
Le résultat sur la formule de \nom{Stirling} montre que $\delta = \sqrt{2\pi}$.
\end{prop}

\begin{remarque}
Une méthode pour déterminer la valeur de la constante $\delta$ est développée dans la partie~\ref{preuve_stirling}.
\end{remarque}

\begin{exercice}
Soient $f$, $g$ deux fonctions continues sur $\Rp$ à valeurs positives. On suppose que $\int_0^{+\infty} f(t) \d t$ converge. On définit la suite $(b_n)_{n\in\N}$ par
\[
b_0 = 0,\,
b_1 = 1
\text{ et }
b_n = 1 + \left(n - \frac{1}{2}\right) \ln\left(1 - \frac{1}{n}\right),\, \forall\, n \in \N.
\]
On considère enfin une suite $(a_n)_{n\in\N}$ de réels positifs.
\begin{questions}
\item Si $f(x) \sim_{+\infty} g(x)$, montrer que $\displaystyle \int_x^{+\infty} f(t) \d t \sim_{+\infty} \int_x^{+\infty} g(t) \d t$.

\item En appliquant la question précédente aux fonctions en escalier $f(t) = \sum_{k=0}^{+\infty} a_k \indicatrice{[k,k+1[}(t)$ et \mbox{$g(t) = \sum_{k=0}^{+\infty} b_k \indicatrice{[k, k+1[}(t)$}, montrer que si $a_n \sim b_n$ et $\sum a_n$ converge, alors $\sum\limits_{k=n+1}^{+\infty} a_k \sim \sum\limits_{k=n+1}^{+\infty} b_k$.

\item Montrer que $\sum b_n$ converge.

\item Montrer que $\sum\limits_{k=n+1}^{+\infty} \frac{1}{k^2} \sim \frac{1}{n}$.

\item Conclure.
\end{questions}
\end{exercice}

\begin{elemdemo}
\begin{reponses}
\item Soit $\varepsilon > 0$. La fonction $g$ étant strictement positive et comme $f \sim g$, il existe $a \in \Rp$ tel que
\[
\forall\, t \in [a, +\infty[,\, 0 < \abs{f(t) - g(t)} \leq \varepsilon g(t).
\]
Ainsi, comme $g$ est intégrable sur $[a, +\infty[$, alors $f - g$ l'est également. D'après la croissance de l'intégrale et l'inégalité triangulaire,
\[
\forall\, x \in [a, +\infty[,\, 0 \leq \abs{\int_x^{+\infty} f(t) \d t - \int_x^{+\infty} g(t) \d t} \leq \varepsilon \int_x^{+\infty} g(t) \d t.
\]
Ainsi, $\int_x^{+\infty} f(t) \d t \sim_{+\infty} \int_x^{+\infty} g(t) \d t$.

\item Posons $f_k : t \mapsto a_k \indicatrice{[k,k+1[}(t)$. Alors, $\sum f_k$ converge simplement sur $\Rp$ vers $f$. De plus, la fonction $f$ est continue par morceaux. Enfin,
\[
\sum \int_0^{+\infty} f_k(t) \d t = \sum a_k
\]
converge. Ainsi, d'après le \theoremeutilise{théorème d'intégration terme à terme}{theo:integrationtermeaterme},
\[
\int_0^{+\infty} f(t)
= \sum_{n=0}^{+\infty} \int_0^{+\infty} f_n(t) \d t
= \sum_{n=0}^{+\infty} a_n.
\]
Le même résultat est obtenu pour la fonction $g$.

Il suffit alors d'appliquer la question précédente aux fonctions $f$ et $g$.

\item On remarque que $b_n \sim -\frac{1}{12 n^2}$. En posant $a_n = -\frac{1}{12 n^2}$, alors $\sum a_n$ converge. Ainsi, d'après la question précédente,
\[
\sum_{k=n+1}^{+\infty} a_n \sim \sum_{k=n+1}^{+\infty} b_n.
\]

\item On utilise une comparaison série / intégrale. La fonction $x \mapsto \frac{1}{x^2}$ est décroissante. Pour $k > 2$ et $t \in [k, k + 1]$,
\begin{align*}
\frac{1}{t^2} &\leq \frac{1}{k^2} \leq \frac{1}{(t - 1)^2}\\
\int_k^{k+1} \frac{\d t}{t^2} &\leq \frac{1}{k^2} \leq \int_k^{k+1} \frac{\d t}{(t - 1)^2}\\
\int_{n+1}^{+\infty} \frac{\d t}{t^2} &\leq \sum_{k=n+1}^{+\infty} \frac{1}{k^2} \leq \int_{n+1}^{+\infty} \frac{\d t}{(t - 1)^2}\\
\frac{1}{n + 1} &\leq \sum_{k=n+1}^{+\infty} \frac{1}{k^2} \leq \frac{1}{n}.
\end{align*}
Ainsi, d'après le \theoremeutilise{théorème d'encadrement}{theo:encadrement},
\[
\sum_{k=n+1}^{+\infty} \frac{1}{k^2} \sim \int_n^{+\infty} \frac{\d t}{t^2} = \frac{1}{n}.
\]

\item D'après la question précédente,
\[
\sum_{k=n+1}^{+\infty} b_k = -\frac{1}{12 n} + o\left(\frac{1}{n}\right).
\]

Ainsi, en notant $\ell = \sum_{k=1}^{+\infty} \frac{1}{k^2}$, alors
\[
\sum_{k=0}^n b_k = \ln\left(\frac{n! \e^n}{n^{n+\frac{1}{2}}}\right) = \ell + \frac{1}{12 n} + o\left(\frac{1}{n}\right).
\]

En utilisant la fonction expontentielle,
\[
\frac{n! \e^n}{n^{n+\frac{1}{2}}} = \e^{\ell} \times \e^{\frac{1}{12 n} + o\left(\frac{1}{n}\right)}.
\]

On obtient le résultat attendu en utilisant le développement limité à l'ordre $1$ de la fonction exponentielle.
\end{reponses}
\end{elemdemo}

\begin{comment}
\begin{prop}
    Soit $f: \Rp \rightarrow \C$ une fonction continue par morceaux et $g, h:\Rp \rightarrow \Rp$ deux fonctions continues par morceaux, strictement positives. On suppose que $f = o_{+\infty}(g)$ et $f \sim_{+\infty} h$.\\
    \begin{itemize}
        \item Si $g$ et $h$ ne sont pas intégrables sur $\Rp$,
        $$\int_{0}^{x} f = o_{+\infty} \left(\int_{0}^{x} g \right) \text{ et } \int_{0}^{x} f \sim_{+\infty} \int_{0}^{x} h.$$
        \item Si $g$ et $h$ sont intégrables sur $\Rp$,
        $$\int_{x}^{+\infty} f = o_{+\infty} \left(\int_{x}^{+\infty} g \right) \text{ et } \int_{x}^{+\infty} f \sim_{+\infty} \int_{x}^{+\infty} h.$$
    \end{itemize}
\end{prop} 

La démonstration est analogue à celle de la \nameref{sommation_relations_comparaison}


\todoinline{J'ai relu. Sans illustrations et sans application, est-ce qu'on le laisse ? Ou alors on trouve une application, mais je n'en ai pas sous le coude à l'instant !}

\begin{theo}[Intégrales de \textsc{Bertrand}]
    Soient $(\alpha, \beta) \in  \R^2$ et 
    $$f:t \mapsto \frac{1}{t^{\alpha} \ln^{\beta} (t)}.$$
    Alors,
    $$\int_{2}^{+ \infty} f(t) \d t \text{ converge si et seulement si }
    \begin{cases}
    \alpha > 1 \\
    \text{ou}\\
    \alpha = 1 \text{ et } \beta > 1
    \end{cases}.
    $$
\end{theo}

% \todoinline{On écrit plutôt $\int_2^{+\infty} f(t) dt$ et $\int_{[2,+\infty[} f$.}

\begin{demo}
    Distinguons trois cas selon les valeurs prises par $\alpha$:
    \begin{enumerate}
        \item[$\rhd$] \textbf{Cas où $\alpha > 1$.} Soit $\gamma \in \interoo{1}{\alpha}$. Par croissances comparées,
        $$\displaystyle \frac{1}{t^{\alpha} \ln^{\beta} (t)} = o_{+ \infty} \left( \frac{1}{t^{\gamma}} \right).$$
        Or, d'après la convergence des intégrales de \textsc{Riemann}, la fonction $t \mapsto \frac{1}{t^\gamma}$ est intégrable sur $[2, +\infty[$ car $\gamma > 1$. Ainsi, en appliquant les théorèmes de comparaison, $\int_2^{+ \infty} f$ converge.

        \item[$\rhd$] \textbf{Cas où $\alpha < 1$.} Soit $\gamma \in \interoo{\alpha}{1}$. Par croissances comparées,
        $$t^{\gamma} f(t) \xrightarrow[t \to + \infty]{} + \infty$$
        donc à partir d'un certain rang, $f(t) \geqslant \frac{1}{t^{\gamma}} > 0$. Or, d'après la convergence des intégrales de \textsc{Riemann}, la fonction $t \mapsto \frac{1}{t^\gamma}$ n'est intégrable pas sur $[2, +\infty[$ car $\gamma < 1$. Ainsi, en appliquant les théorèmes de comparaison (les intégrandes sont positives), $\int_2^{+ \infty} f$ diverge.
        
        \item[$\rhd$] \textbf{Cas où $\alpha = 1$.} Revenons aux intégrales partielles: soit $X > 2$,
        $$\int_{2}^{X} \frac{1}{t \ln^{\beta} (t)} \d t = 
        \begin{cases}
            \left[ \frac{\ln ^{1-\beta} (t)}{1-\beta} \right]_2 ^X & \text{si } \beta \not = 1, \\
            \left[\ln (\ln t) \right]_2 ^X & \text{si } \beta = 1.
        \end{cases}
        $$
        On en déduit que l'intégrale de la fonction $t \mapsto \frac{1}{t \ln^{\beta} (t)}$ converge sur $[2, + \infty[$ si et seulement si $\beta > 1$.
    \end{enumerate}
\end{demo}
\end{comment}

\begin{comment}
\todoinline{J'ai mis dans "documents" le sujet Centrale PC 2003 - Il fait à la fois des relations de comparaisons, de l'intégrale de Bertrand à la fin et une intégrale fonction des bornes. C'est peut être une bonne idée !}

\todoarmand{Effectivement, c'est une bonne idée. Ça permettrait de supprimer l'exercice sur l'intégrale de Bertrand et de l'intégrer avec celui-ci}

\begin{exercice}
Soient $a\in \R,\, b \in \interoo{a}{+\infty} \cup \ens{+\infty}$ et $f, g$ deux applications continues par morceaux sur $\interfo{a}{b}$ à valeurs strictement positives.
\begin{questions}
    \item On suppose que $g$ est intégrable sur $\interfo{a}{b}$.
    \begin{questions}
        \item Montrer que, en $b$, la relation $f = o(g)$ entraîne $\int_x^{b} f = o\left(\int_x^b g\right)$. \\
        \emph{
        On n'hésitera pas à raisonner en utilisant des $\eg$.
        }
        \item Montrer que, en $b$, la relation $f \sim g$ entraîne $\int_x^{b}f \sim \left(\int_x^b g\right)$. \\
        \emph{
        On justifiera l'intégrabilité de $f$ sur les intervalles $\interfo{x}{b}$ considérés.
        }
    \end{questions}
    \item On suppose que $g$ n'est pas intégrable sur $\interfo{a}{b}$
    \begin{questions}
        \item Montrer que, en $b$, la relation $f = o(g)$ entraîne $\int_a^{x} f(t) \d t = o\left(\int_a^x g(t) \d t\right)$.
        Montrer à l'aide d'exemples que l'on ne peut rien dire de l'intégrabilité de $f$ sur $\interfo{a}{b}$.
        \item Montrer que, en $b$, la relation $f \sim g$ entraîne $\int_a^{x} f(t) \d t \sim \int_a^x g(t) \d t$.
        Que peut-on dire de l'intégrabilité de $f$ sur $\interfo{a}{b}$ ?
    \end{questions}
\end{questions}
\end{exercice}

\begin{exercice}
Soit $a$ un nombre réel et $f$ une application de classe $\mathscr{C}^1$ sur $\interfo{a}{+\infty}$ à valeurs strictement positives. On suppose que le quotient $\frac{x f'(x)}{f(x)}$ tend vers une limite finie $\alpha$ en $+\infty.$
\begin{questions}
    \item Montrer, à l'aide des préliminaires que, en $+\infty$, $\frac{\ln(f(x))}{\ln(x)}$ tend vers $\alpha$. \\
    \emph{
    On peut distinguer le cas $\alpha = 0$.
    }
    \item On suppose dans cette question $\alpha < -1.$
    \begin{questions}
        \item Montrer que $f$ est intégrable sur $\interfo{a}{+\infty}$.
        \item Montrer que, en $+\infty$, on a $\int_x^{+\infty} f(t) \d t \sim -\frac{x f(x)}{\alpha + 1}$. \\
        \emph{
        On pourrra considérer $\frac{x f(x)}{\alpha+1}$ et utiliser les préliminaires.
        } 
    \end{questions}
    \item On suppose dans cette question $\alpha > -1.$
    \begin{questions}
        \item Étudier l'intégrabilité de $f$ sur $\interfo{a}{+\infty}.$
        \item Montrer que, en $+\infty$, on a $\int_a^{x} f(t) \d t \sim \frac{x f(x)}{\alpha + 1}$.
        \item Donner un exemple d'application $f$ de classe $\mathscr{C}^1$ sur $\interfo{a}{+\infty}$ à valeurs positives telle qu'en $+\infty$ le quotient $\frac{\ln(f(x))}{\ln(x)}$ tend vers $\alpha > -1,$ mais telle que l'on n'ait pas $\int_a^{x} f(t) \d t \sim \frac{x f(x)}{\alpha+1}$.
    \end{questions}
    \item Étudier l'intégrabilité sur $\interfo{2}{+\infty}$ des applications $ x \mapsto \frac{1}{x (\ln x)^{\beta}}$ selon les valeurs du réel $\beta$.
    \begin{questions}
        \item Étudier, à l'aide des questions précédentes, l'intégrabilité sur $\interfo{2}{+\infty}$ des applications $x \mapsto \frac{1}{x^{\gamma}(\ln x)^{\beta}}$, selon les valeurs des réels $\beta$ et $\gamma$.
        \item Que conclure quant à l'intégrabilité de $f$ sur $\interfo{a}{+\infty}$ dans le cas $\alpha =-1$ ?
    \end{questions}
\end{questions}
\end{exercice}
\end{comment}



%-----------
\subsection{Un exemple avec les séries alternées}

\todoinline{Je pense que l'intérêt de l'écriture sur la somme est d'avoir une approximation de l'intégrale. On tente une illustration de cette rapidité de convergence ?}

\begin{prop}{}
\[
\frac{1}{2} \int_{0}^{+ \infty} \frac{\cos (xt)}{\ch t} \d t = \sum_{n=0}^{+ \infty} \frac{(-1)^n (2n+1)}{(2n+1)^2 + x^2}.
\]
\end{prop}

\begin{exercice}
On pose $f : t \mapsto \frac{\cos(x t)}{\e^t + \e^{-t}}$ et $f_n : t \mapsto (-1)^n \cos(x t) \e^{-(n + 1) t}$.
\begin{questions}
\item Justifier la convergence de $\displaystyle\frac{1}{2} \int_{0}^{+ \infty} \frac{\cos (xt)}{\ch t} \d t$.

\item Montrer que $f(x) = \sum\limits_{n=0}^{+\infty} (-1)^n \cos(x t) \e^{-(2 n + 1) t}$.

\item Déterminer $\displaystyle\int_0^{+\infty} f_n(t) \d t$.

\item Conclure en utilisant le \theoremeutilise{théorème des séries alternées}{theo:seriesalternees}.
\end{questions}
\end{exercice}

\begin{elemsolution}
\begin{reponses}
\item La fonction $f \colon t \mapsto \frac{\cos(x t)}{2 \ch(t)}$ est continue sur $[0, +\infty[$. De plus, $|f(t)| \leq \frac{1}{\ch(t)}$ et $\frac{1}{\ch(t)} \sim_{+\infty} 2 \e^{-t}$. Ainsi, la fonction $f$ est intégrable sur $[0, +\infty[$ et l'intégrale converge.

\item En utilisant le développement en série entière de la fonction inverse, comme $0 < \e^{-2t} < 1$ sur $]0, +\infty[$, 
\begin{align*}
f(t)
&= \frac{\cos(x t)}{\e^t + \e^{-t}}
= \e^{-t} \cos(x t) (1 + \e^{-2t})^{-1}\\
&= \e^{-t} \cos(x t) \sum_{n=0}^{+\infty} (-1)^n \e^{-2 n t}\\
&= \sum_{n=0}^{+\infty} (-1)^n \cos(x t) \e^{- (2 n + 1) t}.
\end{align*}

\item En utilisant la formule d'\nom{Euler},
\begin{align*}
(-1)^n \int_0^{+\infty} f_n(t) \d t
&= \Reel\mathopen{}\left(\int_0^{+\infty} \e^{(\i x - (2 n + 1)) t} \d t\right)\\
&= \Reel\mathopen{}\left(-\frac{1}{\i x - (2 n + 1)}\right)\\
&= \frac{2 n + 1}{x^2 + (2 n + 1)^2}.
\end{align*}

\item Remarquons que la série de terme général $(-1)^n \e^{- (2 n + 1) t}$ est une série alternée. Ainsi,
\begin{align*}
\left|\sum_{n=N+1}^{+\infty} (-1)^n \e^{-(2 n + 1) t}\right|
&\leq \e^{-(2 N + 1) t}.
\end{align*}
Alors,
\begin{align*}
\module{\sum_{n=0}^N f_n(t)}
&\leq \module{f(t) - \sum_{n=0}^N f_n(t)} + \module{f(t)}
= \module{\sum_{n=N+1}^{+\infty} f_n(t)} + \module{f(t)}
&\leq |f(t)| + \e^{-(2N+1) t} \leq \module{f(t)} + \e^{-t}.
\end{align*}

Ainsi, $\left(\sum\limits_{n=0}^N f_n\right)_{n\in\N}$ converge simplement vers $f$ et ses sommes partielles sont dominées par une fonction intégrable. Donc, d'après le \theoremeutilise{théorème de convergence dominée}{theo:convergencedominee},
\begin{align*}
\int_0^{+\infty} f(t) \d t
&= \lim_{N\to+\infty} \sum_{n=0}^N \int_0^{+\infty} f_n(t) \d t\\
\int_0^{+\infty} \frac{\cos(x t)}{2 \ch(t)} \d t
&= \sum_{n=0}^{+\infty} \frac{(-1)^n (2 n + 1)}{x^2 + (2 n + 1)^2}.
\end{align*}
\end{reponses}
\end{elemsolution}