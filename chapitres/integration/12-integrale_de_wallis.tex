\section{Intégrale de \textsc{Wallis}} \label{integrale_wallis}

\todoinline{Pour moi il faut faire le lien quelque part avec la formule de Stirling.}

\todoinline{On pourrait appliquer Wallis pour calculer l'intégrale de Gauss. Il faut que je retrouve cet exercice mais il permet d'utiliser les théorèmes de convergence dominée.}

\todoarmand{C'est ce qui est fait (différemment) ligne 143 du fichier}

\begin{defi}{Intégrale de \textsc{Wallis}}
    $$\Wallis_n \defeq \int_{0}^{\frac{\pi}{2}} \sin(x)^n \d x = \int_{0}^{\frac{\pi}{2}} \cos(x)^n \d x$$
\end{defi}

\begin{prop}{} \labprop{prop_wallis}
    $$\Wallis_{2p} = \frac{\binom{2p}{p}}{2^{2p}}\frac{\pi}{2} \text{ et } \Wallis_{2p+1} = \frac{2^{2p} (p!)^2}{(2p+1)!}$$
    $$\Wallis_{n+1} \sim \Wallis_n \qquad \Wallis_n \sim \sqrt{\frac{\pi}{2n}}$$
    $$\Wallis_n \Wallis_{n+1} = \frac{\pi}{2(n+1)}$$
\end{prop}

\begin{preuve}
    Calculons $\Wallis_{n+2}$ en effectuant une intégration par parties. On pose $u(t) \defeq - \cos(t)$ et $v(t) \defeq \sin(t)^{n+1}$, toutes deux de classe $\mathscr{C}^1$ sur $\left[0, \frac{\pi}{2} \right]$. 
    \begin{align*}
        \Wallis_{n+2} &= \underbrace{\left[ -\cos(t) \sin(t)^{n+1} \right]_0^{\pi/2}}_{=0} + (n+1) \int_0^{\pi/2} \cos(t)^2 \sin(t)^n \d t \\
        &= (n+1) \int_0^{\pi/2} \big(1 - \sin(t)^2 \big) \sin(t)^n \d t \\
        &= (n+1) \Wallis_n - (n+1) \Wallis_{n+2} \\
        \text{soit } (n+2) \Wallis_{n+2} &= (n+1) \Wallis_n.
\end{align*}
Soit $p \in \N$. D'après la relation précédente, 
\begin{figure*}[h!]
\begin{multicols}{2}
\begin{align*}
    \Wallis_{2p} &= \frac{2p-1}{2p} \Wallis_{2p-2} \\
    &= \frac{2p-1}{2p} \times \frac{2p-3}{2p-2} \times \cdots \times \frac{1}{2} \times \underbrace{\Wallis_0}_{=\pi/2} \\
    &= \frac{\prod\limits_{k=1}^p (2k+1)}{\prod\limits_{k=1}^{p+1} (2k)} \frac{\pi}{2} \\
    &= \frac{\left[\prod\limits_{k=1}^p (2k+1) \right] \times \left[ \prod\limits_{k=1}^{p+1} (2k) \right]}{\left[\prod\limits_{k=1}^{p+1} (2k) \right]^2} \frac{\pi}{2} \\
    \Wallis_{2p} &= \frac{(2p)!}{2^{2p}(p!)^2} \frac{\pi}{2}.
\end{align*}
\begin{align*}
    \Wallis_{2p+1} &= \frac{2p}{2p+1} \Wallis_{2p-1} \\
    &= \frac{2p}{2p+1} \times \frac{2p-2}{2p-1} \times \cdots \times \frac{2}{3} \times \underbrace{\Wallis_1}_{=1} \\
    &= \frac{\prod\limits_{k=1}^p (2k)}{\prod\limits_{k=0}^p (2k+1)} \\
    &= \frac{\left[ \prod\limits_{k=1}^p (2k) \right]^2}{\left[ \prod\limits_{k=0}^p (2k+1) \right] \left[ \prod\limits_{k=1}^p (2k) \right]} \\
    \Wallis_{2p+1} &= \frac{2^{2p}(p!)^2}{(2p+1)!}.
\end{align*}
\end{multicols}
\end{figure*}
\end{preuve}

\subsection{Formule de \textsc{Stirling}} \label{preuve_stirling}

\textcolor{red}{Ajouter un texte d'introduction}

\todoinline{Pour le calcul de Wallis, utiliser la section précédente. Ça peut être rentable de mettre Wallis à part puis de l'utiliser d'une part pour l'intégrale de Gauss et d'autre part ici.}

\begin{theo}{\textsc{Stirling}}
    $$n! \sim \left(\frac{n}{\e}\right)^n \sqrt{2 \pi n}$$
\end{theo}

\begin{elem_preuve}
    \begin{enumerate}
        \item Montrer que $\left( \frac{n!\e^n}{\sqrt{n}n^n} \right)_{n \in \Ne}$ converge vers $\ell \in \R$
        \item Montrer que $\ell = \sqrt{2 \pi}$ en utilisant l'\nameref{integrale_wallis}:
        $$\Wallis_n \defeq \int_{0}^{\pi/2}\sin^n(t) \d t$$
        \begin{enumerate}
            \item Montrer que $(\Wallis_n)_{n \in \N}$ est décroissante
            \item Exprimer $\Wallis_{n+2}$ en fonction de $\Wallis_n$ grâce à une IPP: $$(n+2)\Wallis_{n+2} = (n+1)\Wallis_n$$
            \item Exprimer $\Wallis_{2p}$ et $\Wallis_{2p+1}$ en fonction de $p$:\\
            $$\Wallis_{2p} = \frac{\binom{2p}{p}}{2^{2p}}\frac{\pi}{2} \text{ et } \Wallis_{2p+1} = \frac{2^{2p} (p!)^2}{(2p+1)!}$$
            \item Utiliser les points (a) et (b) pour montrer que $\frac{\Wallis_n}{\Wallis_{n+1}} \longrightarrow 1$
            \item Utiliser les points (c) et (d) pour montrer que $\left ( \frac{2^n n!}{n ((2n)!)^2} \right)^4 \longrightarrow \pi$
            \item Utiliser le point 1. pour déterminer $\ell$
        \end{enumerate}
    \end{enumerate}
\end{elem_preuve}

\subsection{Séries génératrices}

\todoinline{C'est rigolo ! Est-ce qu'on pourrait retrouver l'expression de $W_n$ à l'aide d'un produit de DSE ? Il y a aussi une application ici : https://math-os.com/coefficient-binomial-central/}

\textcolor{red}{Ajouter un texte d'introduction}

\begin{prop}{}
    \marginnote[0cm]{Source : \href{https://fr.wikipedia.org/wiki/Intégrale_de_Wallis}{Intégrale de \textsc{Wallis} -- \textsf{wikipedia.org}}}
    La série génératrice des termes pairs est 
    $$\sum_{p=0}^\infty \Wallis_{2p} x^{2p} = \frac{\pi}{2} \frac{1}{\sqrt{1-x^2}}.$$
    La série génératrice des termes impairs est 
    $$\sum_{p=0}^\infty \Wallis_{2p+1} x^{2p+1} = \frac{\arcsin x}{\sqrt{1-x^2}}.$$
\end{prop}

\begin{preuve}
    Correction RECOPIEE (pour le cas impair) avec quelques précisions supplémentaires de \url{https://math-os.com/coefficient-binomial-central/} \\
    Pour tout $x \in \interoo{-1}{1}$, 
    \begin{align*}
        \sum_{p=0}^\infty \Wallis_{2p+1} x^{2p+1} = \sum_{p=0}^\infty x^{2p+1} \int_0^{\pi/2} \cos(t)^{2p+1} \d t
    \end{align*}
    La série d'applications $\sum\limits_{p \geqslant 0} \Big[ t \mapsto x^{2p+1} \cos(t)^{2p+1} (t) \Big]$ converge normalement et donc uniformément car $\sum\limits_{p \geqslant 0} \norm{f_p(t)}_\infty = \sum\limits_{p \geqslant 0} x^{2p+1} < +\infty$ (sur $\interff{0}{\frac{\pi}{2}}$). Nous pouvons donc permuter la somme et l'intégrale :
    \begin{align*}
        \sum_{p=0}^\infty \Wallis_{2p+1} x^{2p+1} &= \int_0^{\pi/2} x\cos(t) \sum_{p=0}^\infty \Big(\big(x\cos(t) \big)^2 \Big)^p \d t \\
        &= \int_0^{\pi/2} \frac{x \cos(t)}{1 - x^2 \cos(t)^2} \d t.
    \end{align*}
    On voit rapidement que le changement de variable $u = x \cos(t)$ ne permet pas d'aboutir mais ne remplaçant $\cos(t)^2$ par $1 - \sin(t)^2$ au dénominateur puis en posant $u = x \sin(t)$, il vient:
    \begin{align*}
        \sum_{p=0}^\infty \Wallis_{2p+1} x^{2p+1} &= \int_0^{\pi/2} \frac{x \cos(t)}{1 - x^2 + x^2 \sin(t)^2} \d t \\
        &= \int_0^x \frac{1}{1 - x^2 + u^2} \d u \\
        &= \frac{1}{\sqrt{1 - x^2}} \int_0^x \frac{\frac{1}{\sqrt{1 - x^2}}}{1 + \left(\frac{u}{\sqrt{1-x^2}}\right)^2} \d u \\
        &= \frac{1}{\sqrt{1 - x^2}} \left[ \arctan \frac{u}{\sqrt{1 - x^2}} \right]^x_0 \\
        &= \frac{1}{\sqrt{1 - x^2}} \arctan \frac{x}{\sqrt{1 - x^2}}
    \end{align*}
\marginnote[-5cm]{
Montrons que pour tout $x \in \interoo{-1}{1}$
\[
\arctan \Big(\frac{x}{\sqrt{1-x^2}} \Big) = \arcsin(x).
\]
\begin{tikzpicture}[
  my angle/.style={
    every pic quotes/.append style={text=cyan},
    draw=cyan,
    angle radius=1cm,
  }]
  \coordinate (C) at (-1.5,-1);
  \coordinate (A) at (1.5,-1);
  \coordinate (B) at (1.5,1);
  \draw (C) -- node[above] {$1$} (B) -- node[right] {$x$} (A) -- node[below] {$\sqrt{1-x^2}$} (C);
  \draw (A) +(-.25,0) |- +(0,.25);
  \pic [my angle, "$\alpha$"] {angle=A--C--B};
  % \pic [my angle, "$\beta$"] {angle=C--B--A};
\end{tikzpicture}
}
    Pour la cas pair,
    \begin{align*}
        \sum_{p=0}^\infty \Wallis_{2p} x^{2p} &= \int_0^{\pi/2} \frac{1}{1 - x^2 \cos(t)^2} \d t \\
        &= \int_0^1 \frac{1}{1 - x^2 \left(\frac{1-u^2}{1+u^2}\right)^2} \frac{2}{1 + u^2} \d u \quad \text{en posant } u = \tan \frac{t}{2} \\
        &= \int_0^1 \frac{1 + u^2}{(1 + u^2)^2 - x^2(1-u^2)^2} \d u \\
        &= \int_0^1 \frac{1 + u^2}{(1 + u^2 - x(1-u^2))(1 + u^2 + x(1-u^2))} \d u \\
        &= \frac{1}{2} \int_0^1 \left[ \frac{1}{1 + u^2 - x(1-u^2)} + \frac{1}{1 + u^2 + x(1-u^2)}\right] \d u \\
        &= \frac{1}{2} \int_0^1 \left[\frac{1}{1 - x + (1+x)u^2} + \frac{1}{1 + x + (1-x)u^2} \right] \d u \\
        &= \frac{1}{\sqrt{1-x^2}} \arctan \sqrt{\frac{x+1}{x-1}} + \frac{1}{\sqrt{1-x^2}} \arctan \sqrt{\frac{x-1}{x+1}}\\
        \sum_{p=0}^\infty \Wallis_{2p} x^{2p} &= \frac{\pi}{2} \frac{1}{\sqrt{1-x^2}} \quad \text{car $\arctan x + \arctan \frac{1}{x} = \frac{\pi}{2}$ si $x > 0$}
    \end{align*}
\end{preuve}

\begin{exercice}
    Soit $x \in ]0,1[$. Calculer $\sum\limits_{n=0}^\infty (-1)^n \Wallis_n$ puis $\sum\limits_{n=0}^\infty \Wallis_n x^n$.
\end{exercice}

\begin{solution}
    \marginnote[0cm]{Source : \href{http://exo7.emath.fr/ficpdf/fic00126.pdf}{Exercices de Jean-Louis \textsc{Rouget} (fic00126) -- \textsf{http://exo7.emath.fr}}}
    D'après \vrefprop{prop_wallis}, $\Wallis_n \sim \sqrt{\frac{\pi}{2n}}$ et la règle de \textsc{d'Alembert} fournit $R = 1$. Soit $x \in ]-1, 1[$. \\
    Pour tout $t \in \left[ 0, \frac{\pi}{2} \right]$ et tout entier naturel $n$, $|x^n \cos^n t| \leqslant |x|^n$. Comme la série numérique de terme général $|x|^n$ converge, la série de fonctions de terme général $t \mapsto x^n \cos^n t$ est normalement convergente et donc uniformément convergente sur le segment $\left[ 0, \frac{\pi}{2} \right]$. D'après le théorème d'intégration terme à terme sur un segment, 
    \begin{align*}
        \sum_{n=0}^{+ \infty} \Wallis_n x^n &= \sum_{n=0}^{+ \infty} \left[ x^n \int_0^{\pi/2} \cos^n t \d t \right] = \int_0^{\pi/2} \left( \sum_{n=0}^{+\infty} x^n \cos^n t \right) \d t \\
        &=\int_0^{\pi/2} \frac{1}{1 - x \cos t} \d t \\
        &= \int_0^1 \frac{1}{1 - x \frac{1-u^2}{1+u^2}} \frac{2}{1 + u^2} \d u \quad \text{en posant } u = \tan \frac{t}{2} \\
        &= 2 \int_0^1 \frac{1}{(1+x)u^2 + (1-x)} \d u \\
        &= 2 \times \frac{1}{1+x} \times \frac{1}{\sqrt{\frac{1-x}{1+x}}} \left[ \arctan \left( \frac{u}{\sqrt{\frac{1-x}{1+x}}} \right) \right]_0^1 \\
        \sum_{n=0}^{+ \infty} \Wallis_n x^n &= \frac{2}{\sqrt{1-x^2}} \arctan \sqrt{\frac{x+1}{x-1}}.
    \end{align*}
\end{solution}

\todoarmand{Nouvel exercice de \cite{exos_oraux}}

\begin{exercice}
    \textbf{Fonction de \textsc{Bessel} et intégrales de \textsc{Wallis}} \\
    Pour tout $x \in \R$, on note $J(x) = \displaystyle \int_0^{\pi/2} \cos\big(x \sin(t) \big) \d t$.
    \begin{enumerate}
        \item Montrer que $J$ est solution de l'équation différentielles $x y'' + y' + xy = 0$ $(E)$. 
        \item Déterminer les solutions développables en série entière de $(E)$, puis le développement en série entière de $J$. En déduire une expression des intégrales de \textsc{Wallis} d'indice pair. 
    \end{enumerate}
\end{exercice}

\subsection{Volume d'une boule en dimension \texorpdfstring{$n$}{n}}

\begin{exercice}
    \marginnote[0cm]{Source : \cite{fmaalouf}}
    Pour $n \in \Ne$ et $R \in \Rpe$ on désigne par $V_n(R)$ le volume de la boule de $\R^n$ de centre $O$ et de rayon $R$, 
    $$V_n(R) \defeq \idotsint_{x_1^2 + \cdots + x_n^2 \leqslant R^2} \d x_1 \cdots \d x_n.$$
    Montrer que pour tout $p \in \Ne$, 
    $$V_{2p}(R) = \frac{\pi^p R^{2p}}{p!}.$$
\end{exercice}

\todoinline{Ajouter une preuve.}

\todoarmand{Les exercices 4 et 5 de \url{http://exo7.emath.fr/ficpdf/fic00143.pdf} donnent les liens entre calcul de la surface de la sphère unité de $\R^n$, son volume, la fonction Gamma et les intégrales de Wallis.}

Exercices recopiés : 

\begin{exercice}
\begin{enumerate}
    \item Calculer $\int_{-\infty}^{+\infty} \e^{-x^2} \d x$. \\
    \emph{Indication :} On pourra d'abord calculer $\int_{R^2} \e^{-(x^2 + y^2)} \d x \d y$ en passant en coordonnées polaires. 
    \item \emph{Calcul de l'aire de la sphère unité de $\R^n$.} Soit $\mathscr{S}_{n-1} = \ens[\big]{(x_1, \dots, x_n) \in \R^n \tq \sum\limits_{i=1}^n x_i{}^2 = 1}$ la sphère unité de $\R^n$. On note $\mathscr{A}_{n-1}$ son aire. Calculer
    \[
    \int_{\R^n} \exp\left({-\sum\limits_{i=1}^n x_i{}^2}\right) \d x_1 \dots \d x_n
    \]
    en fonction de $\mathscr{A}_{n-1}$. En déduire l'expression de $\mathscr{A}_{n-1}$ en fonction de la fonction $\Gamma$ :
    \[
    \Gamma(s) \defeq \int_0^{+\infty} x^{s-1} \e^{-x} \d x.
    \]
    \item \emph{Calcul du volume de la boule unité de $\R^n$.} Soit $\mathscr{B}_n = \ens[\big]{(x_1, \dots, x_n) \in \R^n \tq \sum\limits_{i=1}^n x_i{}^2 \leqslant 1}$ la boule fermée de rayon $1$ dans $\R^n$. On note $\mathscr{V}_n$ son volume. Montrer que $\mathscr{V}_n = \frac{\mathscr{A}_{n-1}}{n}$. En déduire que:
    \[
    \mathscr{V}_n = \frac{\pi^{n/2}}{\Gamma \left( \frac{n}{2} + 1 \right)}.
    \]
    \item \emph{Application :} Que vaut l'aire de la sphère de rayon $R$ de $\R^2$ ? $\R^3$ ? Que vaut le volume de la boule de rayon $R$ de $\R$ ? $\R^2$ ? $\R^3$?
\end{enumerate}
\end{exercice}

\begin{exercice}
    \emph{Cet exercice fournit une autre méthode de calcul du volume de la boule unité $\mathscr{B}_n$ de $\R^n$ et de l'aire de la sphère $\mathscr{S}_{n-1} \subset \R^n$.} On conserve les notations de l'exercice précédent. 
    \begin{enumerate}
        \item Montrer que $\mathscr{V}_n = I_n \cdot \mathscr{V}_{n-1}$, où $I_n = \int_0^\pi \sin(t)^n \d t$. 
        \item Vérifier que $I_n = \frac{n-1}{n}I_{n-2}$.
    \end{enumerate}
\end{exercice}

\subsection{\textsc{Grain de raisin}: Produit de \textsc{Wallis}}

\marginnote[0cm]{
    L'expression \chevron{Grain de raisin} est une référence à l'extrait suivant \url{https://youtube.com/clip/UgkxzacmUJF7Qr3526JmMgMOwLirh_c-gddc?si=AUUGMWZPFH8aNZl7} d'une discussion entre Jean-Pierre \textsc{Serre} et Christophe \textsc{Ritzenthaler}.
    % \begin{figure}
    % \centering
    \begin{center}
    \includegraphics[width=1cm]{images/qrcode_grainderaisin.png}
    \end{center}
    % \end{figure}
}

\begin{prop}{Produit de \textsc{Wallis}}
    Formule énoncée en 1656 par John \textsc{Wallis}, dans son ouvrage \emph{Arithmetica infinitorum}
    $$\prod_{n=1}^{\infty} \frac{4n^2}{4n^2-1} = \frac{\pi}{2}.$$
\end{prop}

\begin{preuve}
    Puisque $\Wallis_{2n} \sim \Wallis_{2n+1}$, 
    $$\lim_{n \to +\infty} \frac{\Wallis_{2n+1}}{\Wallis_{2n} / \frac{\pi}{2}} = \frac{\pi}{2}.$$
    Or d'après le calcul des intégrales de \textsc{Wallis}:
    $$\frac{\Wallis_{2n+1}}{\Wallis_{2n} / \frac{\pi}{2}} = \frac{\frac{2^{2p}(p!)^2}{(2p+1)!}}{\frac{(2p)!}{2^{2p}(p!)^2}} = \prod_{k=1}^n \frac{4k^2}{4k^2-1}.$$
\end{preuve}