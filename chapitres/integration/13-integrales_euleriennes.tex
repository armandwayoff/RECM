\section{Intégrales eulériennes}\label{secinteuleriennes}

\source{\href{https://lescoursdemathsdepjh.monsite-orange.fr/file/7bcfcf82249b1046f185e9a3495845cd.pdf}{Fonction eulériennes -- Pierre-Jean \nompropre{Hormière}}}
\todoarmand{Glossaire des mathématiciens : distinguer entre les Bernoulli}
De premières tentatives pour définir la factorielle de valeurs non entières remontent à James \nom{Stirling} et Daniel \nom{Bernoulli}. Dans une lettre à Christian \nom{Goldbach} du 13 octobre 1729, \nom{Euler} découvre (ou invente ?) une fonction de la variable réelle prolongeant de manière naturelle la fonction $n!$. D'abord introduite comme limite de produits, cette fonction fut plus tard présentée sous forme intégrale et reliée à des fonctions voisines.

Les fonctions eulériennes sont les plus importantes \say{ fonctions spéciales } de l'analyse classique, réelle et complexe. \nom{Legendre} les a nommées, classifiées et étudiées. Elles ont aussi été étudiées par \nom{Gauss}, \nom{Binet}, \textsc{Plana}, \textsc{Malmsten}, \textsc{Raabe}, \textsc{Weierstrass}, \textsc{Hankel}, H. \textsc{Bohr}, \textsc{Mollerup}, \textsc{Artin}, \ldots
\todoarmand{Utiliser la commande nom}

On trouvera une présentation du contexte historique de l'extension de la fonction factorielle dans l'article~\cite{davis1959}.

\todoarmand{
\url{https://people.math.osu.edu/gautam.42/S20/DavisGammaFunction.pdf} : un texte passionnant qui raconte en détail toute l'aventure intellectuelle autour de la fonction Gamma et qui explique (p. 18-20) la manière dont on peut construire des pseudo fonctions Gamma qui vérifient l'essentiel des propriétés d'un prolongement de la fonction $n!$.}

Il y a bien des façons de prolonger la fonction $n!$ au domaine réel, même en se limitant aux fonctions continues. Une idée naturelle est de partir de la formule $\displaystyle n! = \int_{0}^{+ \infty} t^n \e^{-t} \d t$. Cette forme intégrale de la factorielle suggère de considérer la fonction $\displaystyle F(x)=\int_{0}^{+ \infty} t^x \e^{-t} \d t$. Cette fonction, définie sur $\interoo{-1}{+\infty}$, prolonge intelligemment la factorielle, en ce sens qu'elle possède des propriétés nombreuses et cohérentes. Par commodité, on considère plutôt $\displaystyle \Gamma(x) = \int_{0}^{+ \infty} t^{x-1} \e^{-t} \d t$.
\todoarmand{Introduction à réécrire à partir de la ressource ci-dessus.}

\subsection{Fonction Gamma d'\nom{Euler}}\label{subsec:FonctionGammaEuler}

%\begin{marginfigure}[3cm]
%    \input{illustrations/i_fonction_gamma}
%    \caption*{\centering Graphe de la fonction Gamma}
%\end{marginfigure}

\begin{defi}[Fonction Gamma d'\nom{Euler}]
    La \emph{fonction Gamma d'\nom{Euler}} est définie par: 
    $$\Gamma(x) \defeq \int_{0}^{+\infty} t^{x-1} \e^{-t} \d t.$$
\end{defi}

\begin{remarque}
    À un changement de variable près, la fonction $\Gamma$ est la \nameref{transformee_laplace} de la fonction $t \mapsto t^x$. 
\end{remarque} 

\begin{theo}[Propriétés fondamentales]
\begin{itemize}
\item La fonction $\Gamma$ est définie sur $\Rpe$.
\item Pour tout $x > 0$, $\Gamma(x+1) = x\Gamma(x)$.
En particulier, pour tout $n \in \N$, $\Gamma(n+1) = n!$. 
\end{itemize}
\end{theo}

\begin{demo}
\begin{itemize}
\item On pose $\fonctionligne[f_x]{t}{t^{x - 1} \e^{-t}}$.

La fonction $f_x$ est continue sur $\R_+^\star$. Comme $f_x$ est à valeurs positives, son intégrabilité est équivalente à la convergence de l'intégrale.

Comme $f_x(t) = o_{+\infty}\mathopen{}\left(\frac{1}{t^2}\right)$, d'après les \theoremeutilise{théorèmes de comparaison aux intégrales de \nom{Riemann}}{theo:comparaisonintegralesriemann}, $f_x$ est intégrable sur $\interfo{1}{+\infty}$.

Comme $f_x(t) \sim_0 \frac{1}{t^{1-x}}$, alors $f_x$ est intégrable sur $\interof{0}{1}$ si et seulement si $x > 0$.

Finalement, $\Gamma$ est définie sur $\Rpe$.

\item Les fonctions $t \mapsto \e^{-t}$ et $t \mapsto t^x$ sont de classe $\Cont^1$ sur $\Rpe$. D'après les croissances comparées, $\lim_{t\to0} t^x \e^{-t} = \lim_{t\to+\infty} t^x \e^{-t} = 0$. 
\item D'après la formule d'\theoremeutilise{intégration par parties généralisée}{theo:ippgeneralisees},
\[
\int_0^{+\infty} t^x \e^{-t} \d t = x \int_0^{+\infty} t^{x-1} \e^{-t} \d t
\]
et $\Gamma(x+1) = x \Gamma(x)$.

\item On remarque que $\Gamma(1) = 1$ et on montre par récurrence que $\Gamma(n+1) = n!$.
\end{itemize}
\end{demo}

% La démonstration est donnée dans \ref{prolongementFonctionGamma}.

% Cette fonction, introduite en 1729 par le mathématicien suisse, prolonge la fonction factorielle à l'ensemble des réels strictement positifs.

\begin{theo}[Régularité]
La fonction $\Gamma$ est de classe $\Cont^\infty$ sur $\Rpe$. De plus,
\[
\forall k \in \N,\quad \forall x \in \Rpe,\quad \Gamma^{(k)}(x) = \int_{0}^{+\infty} (\ln t)^k t^{x-1} \e^{-t} \d t.
\]
\end{theo}

\begin{demo}
\begin{itemize}
\item \textbf{Étude de la continuité.} Soit $0 < a < A$. On pose $\fonctionligne[f]{(x, t)}{t^{x-1} \e^{-t}}$.
\begin{itemize}
\item Soit $t \in \Rpe$. Alors, $f(\,\cdot\,, t)$ est continue sur $\interff{a}{A}$.

\item Soit $x \in \interff{a}{A}$. Alors, $f(x, \cdot)$ est continue sur $\Rpe$.

\item Pour tout $(x, t) \in \interff{a}{A} \times \Rpe$,
\[
\abs{f(x, t)} \leqslant \phi(t) = 
\begin{cases}
\frac{\e^{-t}}{t^{1-a}} &\text{ si } t \in \interof{0}{1},\\
t^{A-1} \e^{-t} &\text{ si } t \in \interfo{1}{+\infty}
\end{cases}
\]
La fonction $\phi$ est continue sur $\Rpe$. De plus, $\phi(t) \sim_0 \frac{1}{t^{1 - a}}$ et $\phi(t) = o_{+\infty}\mathopen{}\left(\frac{1}{t^2}\right)$, donc $\phi$ est intégrable sur~$\Rpe$.
\end{itemize}
Finalement, d'après le \theoremeutilise{théorème de continuité sous le signe intégral}{theo:continuitesoussigneintegral}, $\Gamma$ est continue sur $\interff{a}{A}$ pour tous $0 < a < A$ et $\Gamma$ est donc continue sur $\Rpe$.

\item On applique le \theoremeutilise{théorème de dérivation sous le signe intégral}{theo:derivationsoussigneintegrale} sur l'intervalle $\interff{a}{A}$:
\begin{itemize}
\item la fonction $\fonctionligne[f(\,\cdot\,, t)]{t}{t^{x - 1} \e^{-t}}$ est de classe $\mathscr{C}^k$ sur $\interff{a}{A}$.

\item la dérivée partielle $\partial_1^j f(x, t) = \ln(t)^j t^{x - 1} \e^{-t}$ et $t \mapsto \partial_1^j f(x, t)$ est continue sur $\Rpe$.

\item pour tout $x \in \interff{a}{A}$,
\[
\abs{\partial_1^j f(x, t)} \leqslant
\begin{cases}
\abs{\ln(t)}^j \e^{-t} t^{a-1} &\text{ si } t < 1 \\
\abs{\ln(t)}^j \e^{-t} t^{A-1} &\text{ si } t \geqslant 1
\end{cases}
\]

En notant $\phi_j$ cette fonction,
\begin{itemize}
\item $\phi_j$ est continue sur $\Rpe$.
\item $\phi_j(t) = o_{+\infty}\mathopen{}\left(\frac{1}{t^2}\right)$ et $\phi_j(t) = o_0(t^{a/2-1})$. Ainsi, $\phi_j$ est intégrable sur $\Rp$.
\end{itemize}
\end{itemize}
Finalement, $\Gamma$ est de classe $\mathscr{C}^\infty$ et
\[
\Gamma^{(j)}(x) = \int_0^{+\infty} (\ln t)^j t^{x-1} \e^{-t} \d t.
\]
\end{itemize}
\end{demo}

% \begin{elem_preuve}
    % Utiliser une domination locale sur un segment $[a, A] \subset \R_+^\star$ par la fonction:
    % $$\varphi_k:t \mapsto 
    % \begin{cases}
        % |\ln t |^k \e^{-t} t^{a-1} & \text{si } t \in ]0, 1], \\
        % |\ln t |^k \e^{-t} t^{A-1} & \text{si } t > 1.
    % \end{cases}
    % $$
% \end{elem_preuve}

\begin{exercice}
\source{\cite{fmaalouf}}
\begin{questions}
\item Montrer que $\Gamma(x) \isEquivTo{0^+} \frac{1}{x}$.

\item Montrer que $\Gamma$ est convexe.

\item Montrer que $\ln(\Gamma)$ est convexe.\\
\emph{Indication :} On pourra utiliser l'inégalité de \nom{Cauchy}--\nom{Schwarz}.
% et étudier ses variations.
\end{questions}
\end{exercice}

\begin{solution}
\begin{reponses}
\item Comme $\Gamma$ est continue en $1$, 
\[
\lim_{x\to0} \Gamma(x + 1) = \Gamma(1) = \int_0^{+\infty} \e^{-t} \d t = 1.
\]

De plus, pour tout $x > 0$, $\Gamma(x + 1) = x \Gamma(x)$. Ainsi,
\[
\Gamma(x) \sim_0 \frac{1}{x}.
\]

\item D'après l'étude de régularité précédente, pour tout $x > 0$,
\[
\Gamma''(x) = \int_0^{+\infty} (\ln t)^2 t^{x-1} \e^{-t} \d t.
\]
Ainsi, $\Gamma'' > 0$ et $\Gamma$ est convexe.

\item Comme $\Gamma$ est à valeurs strictement positives, alors la fonction $f = \ln(\Gamma)$ est bien définie. De plus, comme la fonction $\Gamma$ est de classe $\mathscr{C}^2$, alors $f$ est de classe $\mathscr{C}^2$ et
\begin{align*}
f' &= \frac{\Gamma'}{\Gamma},\,
%
f'' = \frac{\Gamma'' \Gamma - (\Gamma')^2}{\Gamma^2}.
\end{align*}

De plus, d'après l'inégalité de \nom{Cauchy}--\nom{Schwarz}, pour tout $x > 0$,
\begin{align*}
\Gamma'(x)^2
&= \left(\int_0^{+\infty} \ln(t) t^{x-1} \e^{-t} \d t\right)^2 \\
&= \left(\int_0^{+\infty} \left(t^{(x-1)/2} \e^{-t/2}\right) \times \left(\ln(t) t^{(x-1)/2} \e^{-t/2}\right) \d t\right)^2 \\
&\leq \left(\int_0^{+\infty} t^{x-1} \e^{-t} \d t\right) \times \left(\int_0^{+\infty} \ln(t)^2 t^{x-1} \e^{-t} \d t\right)^2 \\
&\leq \Gamma(x) \Gamma''(x).
\end{align*}
Ainsi, $f'' \geq 0$ et la fonction $\ln(\Gamma)$ est convexe.
\end{reponses}
\end{solution}

%..............
\subsubsection{Caractérisation de $\Gamma$}

\begin{theo}
\source{\cite{rudin2009}}
Soit $f$ une fonction définie sur $\Rpe$ telle que
\begin{enumerate}
\item pour tout $x > 0$, $f(x + 1) = x f(x)$,
\item $f(1) = 1$,
\item $\ln(f)$ est convexe.
\end{enumerate}
Alors, $f = \Gamma$ et
\[
\forall\, x > 0,\,
\Gamma(x) = \lim_{n\to+\infty} \frac{n! n^x}{x (x + 1) \cdots (x + n)}.
\]
\end{theo}

\begin{exercice}
On pose $g = \ln(f)$.
\begin{questions}
\item Pour tout $n \in \Ne$, déterminer $f(n)$.

\item Montrer que, si $f = \Gamma$ sur $\interof{0}{1}$, alors $f = \Gamma$ sur $\Rpe$.
\end{questions}

Soit $x \in \Rpe$ et $n \in \Ne$.
\begin{questions}[resume]
\item Montrer que
\[
g(n + 1) - g(n) \leq \frac{g(n + 1 + x) - g(n + 1)}{x} \leq g(n + 2) - g(n + 1).
\]

\item En déduire que
\[
x \ln(n) \leq g(x) + \ln\left(x (x + 1) \cdots (x + n)\right) - \ln(n!) \leq x \ln(n + 1).
\]

\item Conclure.
\end{questions}
\end{exercice}

\begin{solution}
\begin{reponses}
\item Comme $f(1) = 1$ et $f(n + 1) = n f(n)$, on montre par récurrence que, pour tout $n \in \Ne$, $f(n) = n!$.

\item D'après la question précédente, $f$ et $\Gamma$ sont égales sur $\Ne$.

Supposons que $f = \Gamma$ sur $\interof{0}{1}$. On montre alors par récurrence sur $n$ que $f = \Gamma$ sur $]n, n + 1]$ car, si $x \in ]n, n + 1]$, alors
\begin{align*}
f(x) = (x - 1) f(x - 1)
\text{ et }
\Gamma(x) = (x - 1) \Gamma(x - 1)
\end{align*}
et $x - 1 \in ]n-1, n]$.

\item Comme la fonction $g$ est convexe, son taux d'accroissement est croissant. En appliquant ce résultat à $t \mapsto \frac{g(n + 1) - g(t)}{n + 1 - t}$ successivement en $n$, $(n + 1 + x)$ et $(n + 2)$, alors
\begin{align*}
\frac{g(n + 1) - g(n)}{(n + 1) - n}
&\leq \frac{g(n + 1) - g(n + 1 + x)}{(n + 1) - (n + 1 + x)}
\leq \frac{g(n + 1) - g(n + 1)}{(n + 1) - (n + 2)}\\
g(n + 1) - g(n) &\leq \frac{g(n + 1 + x) - g(n + 1)}{x} \leq g(n + 2) - g(n + 1).
\end{align*}

\item Comme $g(n + 1) = \ln(n!)$, d'après l'inégalité précédente,
\begin{align*}
\ln(n) &\leq \frac{g(n + 1 + x) - \ln(n!)}{x} \leq ln(n + 1)\\
x \ln(n) &\leq g(n + 1 + x) - \ln(n!) \leq x \ln(n + 1).
\end{align*}

Enfin, d'après la propriété de $f$,
\begin{align*}
g(n + 1 + x)
&= \ln\left(f(n + 1 + x)\right)
= \ln\left((n + x) f(n + x)\right)
= \cdots
= \ln\left((n + x) (n + x - 1) \cdots x f(x)\right)\\
&= g(x) + \ln\left(x (x + 1) \cdots (x + n)\right).
\end{align*}

On obtient ainsi l'encadrement souhaité :
\[
x \ln(n)
\leq g(x) - \ln\frac{n!}{x (x + 1) \cdots (x + n)} \leq x \ln(n + 1).
\]

\item D'après la question précédente,
\[
0 \leq g(x) - \ln \frac{n! n^x}{x (x + 1) \cdots (x + n)} \leq x \ln\left(1 + \frac{1}{n}\right).
\]

Ainsi, d'après le \theoremeutilise{théorème d'encadrement}{theo:encadrement},
\[
\lim_{n\to+\infty} \frac{n! n^x}{x (x + 1) \cdots (x + n)} = g(x).
\]

La fonction $g$ est donc unique et égale à $\Gamma$.
\end{reponses}
\end{solution}

%..............
\subsubsection{$\Gamma$ et $\gamma$}

\begin{defi}{Constante $\gamma$ d'\nom{Euler}}
\source{Oral : Centrale 2 - 2021}
La limite suivante est bien définie et appelée constante $\gamma$ d'\nom{Euler} :
\[
\gamma = \lim_{n\to+\infty} \left(\ln(n) - \sum_{k=1}^n \frac{1}{k}\right).
\]
\end{defi}

\begin{theo}
\[
\Gamma'(1) = -\gamma.
\]
\end{theo}

\source{Patrice \nompropre{Lassère}, p. 210}
\begin{exercice}
Pour tout $n \in \Ne$, on note $H_n = \sum_{k=1}^n \frac{1}{k}$.
\begin{questions}
\item Montrer que 
\[
\Gamma'(1) = \lim_{x \to \infty} \int_0^n \left(1 - \frac{t}{n} \right)^n \ln(t) \d t
\]

\item En utilisant un changement de variable affine, montrer que
\[
\int_0^n \left(1 - \frac{t}{n}\right)^n \ln(t) \d t
= \frac{n}{n+1} \ln(n) + n \int_0^1 (1 - u)^n \ln(u) \d u.
\]


\item En utilisant une \theoremeutilise{intégration par parties généralisée}{theo:ippgeneralisees} puis une factorisation de $(1 - u)^{n+1} - 1$, montrer que
\[
(n+1) \int_0^1 (1 - u)^n \ln(u) \d u
= -\sum_{k=0}^n \int_0^1 (1 - u)^k \d t.
\]

\item En déduire que
\[
\int_0^n \left(1 - \frac{t}{n}\right)^n \ln(t) \d t
= \frac{n}{n + 1} (\ln(n) - H_{n+1}).
\]

\item Conclure.
\end{questions}
\end{exercice}

\begin{solution}
\begin{reponses}
\item La convexité de la fonction exponentielle assure que pour tout $t \in \interff{0}{n}$,
\[
\left(1 - \frac{t}{n}\right)^n \leq \e^{-t}.
\]

Posons $f : t \mapsto \ln(t) \e^{-t}$. La fonction $f$ est continue sur $\Rpe$, $f(t) \sim_0 \ln(t)$ et $f(t) = o_{+\infty}(1/t^2)$. Ainsi, la fonction $f$ est intégrable sur $\Rpe$.

On obtient la limite annoncée en utilisant le \theoremeutilise{théorème de convergence dominée}{theo:convergencedominee}.

\item En effectuant le changement de variable affine $u \mapsto n u$,
\begin{align*}
\int_0^n \left(1 - \frac{t}{n}\right)^n \ln(t) \d t
&= n \int_0^1 \left(1 - u\right)^n \ln(n u) \d u\\
&= n \ln(n) \int_0^1 \left(1 - u\right)^n \d u + n \int_0^1 (1 - u)^n \ln(u) \d u\\
&= \frac{n}{n+1} \ln(n) + n \int_0^1 (1 - u)^n \ln(u) \d u.
\end{align*}

\item Les fonctions $u \mapsto -\frac{(1 - u)^{n+1} - 1}{n+1}$ et $u \mapsto \ln(u)$ sont de classe $\mathscr{C}^1$ sur $]0, 1]$ et, d'après les croissances comparées, leur produit tend vers $0$ en $0$. Ainsi, d'après la formule d'\theoremeutilise{intégration par parties généralisée}{theo:ippgeneralisees} puis à l'aide de la formule de \nom{Bernoulli},
\begin{align*}
(n+1) \int_0^1 (1 - u)^n \ln(u) \d u
&= \int_0^1 \frac{\left(1 - u\right)^{n+1} - 1}{u} \d t
= \int_0^1 \frac{- u \sum_{k=0}^n (1 - u)^k}{u} \d t
= -\sum_{k=0}^n \int_0^1 (1 - u)^k \d t.
\end{align*}

\item Finalement,
\begin{align*}
\int_0^n \left(1 - \frac{t}{n}\right)^n \ln(t) \d t
&= \frac{n}{n+1} \left(\ln(n) - \sum_{k=0}^n \int_0^1 (1 - u)^k \d t\right)
= \frac{n}{n+1} \left(\ln(n) - \sum_{k=0}^n \frac{1}{k+1}\right)
= \frac{n}{n+1} \left(\ln(n) - H_{n+1}\right).\\
\end{align*}

\item La conclusion est alors immédiate.
\end{reponses}
\end{solution}


%..............
\subsubsection{Fonction $\Gamma$ et intégrale de \nom{Gauss}}
\marginnote[0cm]{\href{sec:intGauss}{\faLink~Intégrale de \nom{Gauss}}}

\begin{theo}
$\Gamma\mathopen{}\left(\frac{1}{2}\right) = \sqrt{\pi}$
et pour tout $n \in \Ne$,
$\Gamma\mathopen{}\left(n + \frac{1}{2}\right) = \frac{(2n)!}{4^n n!} \sqrt{\pi}$.
\end{theo}
% \begin{exercice}
    \source{\cite{fmaalouf}}
    % Caculer $\Gamma \left( \frac{1}{2} \right)$, puis $\Gamma \left( n + \frac{1}{2} \right)$ pour tout $n \in \Ne$.
% \end{exercice}

% \marginnote[0cm]{Source : \href{https://fr.wikipedia.org/wiki/Intégrale_de_Gauss#Calcul_de_l'intégrale_de_Gauss}{Intégrale de Gauss -- \textsf{wikipedia.org}}}

\begin{elemdemo}
On utilise le changement de variable $\mathscr{C}^1$ et bijectif $u \mapsto u^2$. Alors,
\begin{align*}
\Gamma\mathopen{}\left( \frac{1}{2} \right)
&= \int_0^{+ \infty} t^{\frac{1}{2}-1} \e^{-t} \d t
= 2 \int_0^{+ \infty} \e^{-u^2} \d u
= \int_{- \infty}^{+ \infty} \e^{-u^2} \d u
= \sqrt{\pi},
\end{align*}
d'après les résultats sur l'intégrale de \nom{Gauss}.

Le second point s'obtient en utilisant l'égalité
\[
\Gamma\left(n + \frac{1}{2}\right) = \frac{n + 2}{2} \Gamma\left(n - 1 + \frac{1}{2}\right).
\]
\end{elemdemo}

%-----------
\subsection{Fonction bêta}

\begin{defi}[Fonction bêta]
Pour tout $(x, y) \in (\Rpe)^2$, on définit
\[
B(x, y)
= \int_0^1 t^{x-1} (1 - t)^{y-1} \d t.
\]
\end{defi}

\begin{remarque}
On pose $f_{x,y} : t \mapsto t^{x-1} (1 - t)^{y-1}$.

La fonction $f_{x,y}$ est continue et à valeurs positives sur $\interoo{0}{1}$.

Comme $f_{x,y}(t) \sim_0 t^{x-1}$, la fonction $f_{x,y}$ est intégrable en $0$ si et seulement $x > 0$.

De même, $f_{x,y}(t) \sim_1 (1 - t)^{y-1}$ et la fonction $f_{x,y}$ est intégrable en $1$ si et seulement si $y > 0$.

La fonction bêta est donc bien définie sur $(\Rpe)^2$.
\end{remarque}


\begin{comment}
\begin{defi}[Fonction bêta]
Pour tout $(p,q) \in \N^2$, on note
$$B(p, q) \defeq \int_{0}^{1} t^p (1-t)^q \d t.$$
\end{defi}
\end{comment}

%..............
\subsubsection{Paramètres entiers}

\begin{theo}[Expression factiorelle de la fonction bêta]
Pour tout $(p,q) \in \N^2$,
    $$B(p+1, q+1) = \frac{p! q!}{(p + q + 1)!}.$$
\end{theo}

\source{
\begin{itemize}
    \item \href{https://fr.wikipedia.org/wiki/Intégrale_d'Euler}{Intégrale d'\nom{Euler} -- \textsf{wikipedia.org}}
    \item \cite{dieudonne1968} Chapitre IV, 3 Intégrales eulériennes, page 125.
\end{itemize}
}

\begin{exercice}
\begin{questions}
\item Déterminer $B(p+1, 1)$.

\item Pour tout $(p, q) \in \N \times \Ne$, montrer que $B(p+1, q+1) = \frac{q}{p + 1} B(p+2, q)$.

\item Conclure.
\end{questions}
\end{exercice}

\begin{solution}
\begin{reponses}
\item On a immédiatement $B(p+1, 1) = \int_0^1 t^p \d t = \frac{1}{p + 1}$.

\item On pose $\fonctionligne[u]{t}{\frac{1}{p+1} t^{p+1}}$ et $\fonctionligne[v]{t}{(1-t)^q}$, toutes deux de classe $\mathscr{C}^1$ sur $\interff{0}{1}$. Alors, d'après la formule d'intégration par parties, 
\begin{align*}
B(p+1, q+1)
&= \left[ \frac{1}{p+1}t^{p+1} \times (1-t)^q \right]_0^1 + \frac{q}{p+1} \int_0^1 t^{p+1} (1-t)^{q-1} \d t
= \frac{q}{p+1} B(p+2, q).
\end{align*}

On en déduit que 
\begin{align*}
B(p+1, q+1)
&= \frac{q}{p+1} \times \frac{q-1}{p+2} \times \cdots \times \frac{1}{p+q} B(p+q+1, 1)
= \frac{p! q!}{(p + q + 1)!}.
\end{align*}
\end{reponses}
\end{solution}

\begin{exercice}[Oral CentraleSupélec 2016]
Soit $p \in \Ne$. On dispose de $p$ urnes numérotées de $1$ à $p$. Chaque urne contient $p$ boules et, pour tout $i \in \interent{1}{p}$, l'urne numéro $i$ contient $i$ boules noires et $p - i$ boules blanches. On effectue l'expérience suivante : choisir au hasard une urne puis effectuer des tirages avec remise dans l'urne choisie. On note, pour $n \in \Ne$, $A_n$ l'événement \textit{on a effectué $2 n$ tirages et obtenu le même nombre de boules blanches que de noires}.

\begin{questions}
\item Exprimer $\mathbf{P}(A_n)$ sous forme d'une somme.

\item On note $b_{n,p}$ la probabilité que la prochaine boule tirée soit blanche sachant que $A_n$ est réalisé. Exprimer~$b_{n,p}$.
\item Calculer $\lim\limits_{p\to+\infty} b_{n,p}$.
\end{questions}
\end{exercice}

\begin{solution}
On note $U_i$ l'événement \textit{Choisir l'urne $i$}.
\begin{reponses}
\item Comme $(U_1,\ldots,U_p)$ est un système complet d'événements, en utilisant la \theoremeutilise{formule des probabilités totales}{theo:formuleprobabilitestotales},
\begin{align*}
\mathbf{P}(A_n) &= \sum_{i=1}^p \mathbf{P}_{U_i}(A_n) \mathbf{P}(U_i) \\
&= \sum_{i=1}^n \binom{2n}{n} \left(\frac{p-i}{p}\right)^n \left(\frac{i}{p}\right)^n.
\end{align*}

\item En utilisant le même raisonnement que précédemment,
\[
b_{n,p}
= \frac{\frac{1}{p} \sum\limits_{i=1}^p \left(1 - \frac{i}{p}\right)^{n+1} \left(\frac{i}{p}\right)^n}{\frac{1}{p} \sum\limits_{i=1}^p \left(1 - \frac{i}{p}\right)^{n} \left(\frac{i}{p}\right)^n} \cdot \frac{\binom{2n+1}{n+1}}{\binom{2n}{n}}.
\]

\item En utilisant les limites des sommes de \nom{Riemann},
\[
\lim\limits_{p\to+\infty} b_{n,p} = \frac{2n+1}{n+1} \cdot \frac{\int_0^1 (1 - x)^{n+1} x^n \d x}{\int_0^1 (1 - x)^n x^n \d x}.
\]
Cette limite vaut donc
\[
\frac{2n+1}{n+1} \cdot \frac{n! (n+1)!}{(2n+2)!} \cdot \frac{(2n+1)!}{n! n!}  = \frac{2n+1}{2n+2}.
\]
\end{reponses}
\end{solution}

%..............
\subsubsection{Des fonctions Bêta et des sommes}

\begin{exercice}
    \source{Clémentine \nompropre{Portal} (PCSI1, Collège Stanislas) feuille d'exo n°7, exo 11}
Soit $(p, q) \in \N^2$.

Déterminer une expression sans signe somme de $\sum\limits_{k=0}^q \binom{q}{k} \frac{(-1)^k}{p+k+1}$.
\end{exercice}

\begin{solution}
En utilisant la formule du binôme de \nom{Newton} puis la linéarité de l'intégrale,
\begin{align*}
B(p+1, q+1)
&= \int_0^1 t^p (1 - t)^q \d t\\
&= \int_0^1 t^p \left(\sum_{k=0}^q \binom{q}{k} (-1)^k t^k\right) \d t\\
&= \sum_{k=0}^q \binom{q}{k} (-1)^k \left(\int_0^1 t^{p + k} \d t\right)\\
&= \sum_{k=0}^q \binom{q}{k} \frac{(-1)^k}{p + k + 1}.
\end{align*}
Ainsi,
\[
\sum_{k=0}^q \binom{q}{k} \frac{(-1)^k}{p + k + 1}
= \frac{p! q!}{(p + q + 1)!}.
\]
\end{solution}

%---------------

\begin{exercice}[Oral Mines 2018]
Montrer que la série $\sum B(n, n)$ converge et déterminer sa somme.
\end{exercice}

\begin{solution}
D'après la définition, $0 \leqslant B(n, n) \leqslant \frac{1}{4^{n-1}}$. Ainsi, $\sum B(n, n)$ converge.

Comme $t^p (1 - t)^q \geqslant 0$ pour $t \in \interff{0}{1}$, d'après le \theoremeutilise{théorème d'interversion série / intégrale}{theo:interversionserieintegrale},
\begin{align*}
\sum_{n=0}^{+\infty} B(n+1, n+1)
&= \int_0^1 \left(\sum_{n=0}^{+\infty} t^n (1 - t)^n\right) \d t \\
&= \int_0^1 \frac{\d t}{1 - t(1 - t)}\\
&= \frac{4}{3} \int_0^1 \frac{\d t}{\left[\frac{2}{\sqrt{3}}(t - 1/2)\right]^2 + 1} \\
&= \frac{2}{\sqrt{3}} \left[\arctan\left(\frac{2}{\sqrt{3}} (t-1/2)\right)\right]_0^1 \\
&= \frac{4}{\sqrt{3}} \arctan\frac{1}{\sqrt{3}} \\
&= \frac{2\pi}{3\sqrt{3}}
\end{align*}
\end{solution}

% --------------

\begin{exercice}[Oral CentraleSupélec 2016]
Soit $p \geqslant 2$ et $q \in \N$. On pose $S(p) = \sum\limits_{n=p}^{+\infty} \binom{n}{p}^{-1}$.
\begin{questions}
\item Montrer l'existence de $S(p)$.

\item Montrer que $S_N(p) = \sum\limits_{n=p}^{N+p} \binom{n}{p}^{-1} = \sum\limits_{n=0}^N (n + p + 1) B(n+1, p+1)$.

\item En déduire que $S(p) = \frac{p}{p-1}$.
\end{questions}
\end{exercice}

\begin{solution}
\begin{reponses}
\item D'après la définition des coefficients binomiaux,
\[
\binom{n}{p}^{-1} = \frac{p (p-1) \cdots 2 \cdot 1}{n (n-1) \cdots (n-p+2) (n-p+1)} = o\mathopen{}\left(\frac{1}{n^2}\right).
\]
Ainsi, d'après les \theoremeutilise{théorèmes de comparaison des séries à termes positifs}{theo:comparaisonseriestermespositifs}, $S(p)$ est bien définie.

\item D'après le théorème précédent,
\[
B(p+1, q+1) = \frac{p! q!}{(p + q + 1) (p + q)!} = \frac{\binom{p+q}{p}^{-1}}{p + q + 1}.
\]

Ainsi, si $p \geqslant 1$,
\begin{align*}
S_N(p)
&= \sum_{n=0}^{N} \binom{n+p}{p}^{-1}
= \sum_{n=0}^{N} (n+p+1) B(n+1, p+1) \\
&= \int_0^1 \sum_{n=0}^N (n+1) t^n (1 -t)^p \d t + \int_0^1 \sum_{n=0}^N p\, t^n (1 - t)^p \d t.
\end{align*}

De plus,
\[
\lim_{N\to+\infty} \sum_{n=0}^N (n + 1) t^n (1 - t)^p = (1 - t)^{p-2}
\quad \text{et} \quad 
\lim_{N\to+\infty} \sum_{n=0}^N t^n (1 - t)^p = (1 - t)^{p-1}.
\]
Comme ces suites sont croissantes et que les fonctions limites sont intégrables sur $\interff{0}{1}$, d'après le \theoremeutilise{théorème de convergence dominée}{theo:convergencedominee},
\begin{align*}
S(p)
&= \int_0^1 (1 -t)^{p-2} \d t + \int_0^1 p (1 - t)^{p-1} \d t 
= \frac{1}{p-1} + p \frac{1}{p}
= \frac{p}{p-1}.
\end{align*}

% \gras{Remarque.} On peut obtenir directement :
% \[
% \binom{n}{p}^{-1} = \binom{n-1}{p-1}^{-1} - \frac{n-p}{n-p+1} \binom{n}{p-1}^{-1}.
% \]
% Ainsi,
% \begin{align*}
% S(p) &= \sum_{n=0}^{+\infty} \binom{n+p}{n}^{-1} = 1 + \sum_{n=1}^{+\infty} \binom{n+p-1}{n-1}^{-1} - \frac{p}{p+1} \sum_{n=1}^{+\infty} \binom{n+p}{p-1}^{-1} \\
% &= 1 + S(p) - \frac{p}{p+1} S(p+1).
% \end{align*}
\end{reponses}
\end{solution}

%..............
\subsubsection{Bêta, Gamma et \nom{Wallis}}

\begin{theo}
Soit $(x, y) \in (\Rpe)^2$.
\begin{enumerate}
\item $B(x, y) = B(y, x)$.

\item $B(1, y) = \frac{1}{y}$.

\item $B(x + 1, y) = \frac{x}{y} B(x, y + 1)$ et $B(x + 1, y) = B(x, y) - B(x, y + 1)$ soit
\[
B(x, y) = \frac{x}{x + y} B(x, y).
\]

\item $B(x, y) = \displaystyle\int_0^{+\infty} \frac{t^{x - 1}}{(1 + t)^{x + y}} \d t$.
\end{enumerate}
\end{theo}

\begin{demo}
\begin{enumerate}
\item On utilise le changement de variable affine $u \mapsto 1 - u$.

\item Simple calcul de primitive.

\item Pour la première égalité, on effectue une intégration par parties avec les fonctions $t \mapsto t^x$ et $t \mapsto -\frac{(1 - t)^y}{y}$, de classe $\mathscr{C}^1$ sur $\interff{0}{1}$.

Pour la deuxième égalité, on décompose $t^x = (1 - t + t) t^{x - 1}$.

Enfin, on résout le système linéaire.

\item On utilise le changement de variable $\mathscr{C}^1$ et bijectif $t \mapsto \frac{t}{1 - t}$.
\end{enumerate}
\end{demo}

\begin{theo}
Pour tout $(x, y) \in (\Rpe)^2$,
\[
B(x, y) = \frac{\Gamma(x) \Gamma(y)}{\Gamma(x + y)}.
\]
\end{theo}

\begin{demo}
On pose $f : x \mapsto \frac{B(x, y) \Gamma(x + y)}{\Gamma(y)}$.
\begin{itemize}
\item
\begin{align*}
f(1)
&= \frac{B(1, y) \Gamma(y + 1)}{\Gamma(y)}
= \frac{\frac{1}{y} y \Gamma(y)}{\Gamma(y)}
= 1.
\end{align*}

\item Pour $x > 0$,
\begin{align*}
f(x + 1)
&= \frac{B(x + 1, y) \Gamma(x + 1 + y)}{\Gamma(y)}
= \frac{\frac{x}{x + y} B(x, y) (x + y) \Gamma(x + y)}{\Gamma(y)}
= x f(x).
\end{align*}

\item D'après la définition, pour tout $x > 0$,
\[
\ln(f(x)) = \ln(B(x, y)) + \ln(\Gamma(x + y)) - \ln(\Gamma(y)).
\]
D'après les parties précédentes, $x \mapsto \ln(\Gamma(x + y))$ est convexe.

On montre de manière analogue, en utilisant l'\theoremeutilise{inégalité de \nom{Cauchy}--\nom{Schwarz}}{theo:inegalitecs}, que $x \mapsto \ln(B(x, y))$ est convexe.

Finalement, $\ln(f)$ est convexe.
\end{itemize}
Finalement, d'après la caractérisation de la fonction $\Gamma$,
\[
\forall\, (x, y) \in (\Re)^2,\,
\frac{B(x, y) \Gamma(x + y)}{\Gamma(y)} = \Gamma(x).
\]
\end{demo}

\begin{remarque}
Pour prouver cette relation entre $B$ et $\Gamma$, une autre méthode utilisant la méthode des rectangles est présentée dans le sujet \textsl{Mathématiques 1, session 2009, filière \textsc{mp}} du concours Centrale-Supélec \cite{cs_1_2009}. \\
Le sujet propose également une démonstration de la relation 
\[
B(x, 1 - x) = \Gamma(x) \Gamma(1 - x) = \frac{\pi}{\sin(\pi x)}.
\]
\end{remarque}

% \todoinline{Citer proprement (si nécessaire car tout ici est très classique : soit 
% \url{https://claude-gimenes.fr/mathematiques/calcul-integral/-i-integrales-euleriennes}
% }

\begin{theo}
Pour tout $n \in \N$,
\[
\Wallis_n = \frac{1}{2} B\mathopen{}\left(\frac{n+1}{2}, \frac{1}{2} \right) = \frac{1}{2} \frac{\Gamma\mathopen{}\left(\frac{n+1}{2}\right) \sqrt{\pi}}{\Gamma\mathopen{}\left(\frac{n}{2}+1\right)}
\]
\end{theo}

\begin{elemdemo}
Après le changement de variable $\sin x = \sqrt{t}$ dans l'intégrale de \nom{Wallis} $\Wallis_n$, on obtient
\[
\Wallis_n = \frac{1}{2} \int_0^1 t^{\frac{n-1}{2}} (1-t)^{-\frac{1}{2}} \d t
\]
\end{elemdemo}
